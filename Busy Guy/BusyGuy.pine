//@version=5
strategy("SMA200 Strategy", overlay=true)

// Define the strategy parameters
smaPeriod = input.int(200, "SMA Period", minval=1, tooltip="SMA Period")
stoplossPct = input.float(1, "Stop Loss %", minval=0, tooltip="Stop Loss %")

// Calculate the SMA
sma200 = ta.sma(close, smaPeriod)

// Generate buy signal
buySignal = close >= sma200 and month(time) != month(time[1])

// Generate sell signal
sellSignal = close < sma200 and month(time) != month(time[1])

// Store the position size
positionSize = strategy.position_size

// Submit the entry orders
if buySignal and positionSize == 0
    strategy.entry("Buy", strategy.long)
else if sellSignal and positionSize > 0
    strategy.entry("Sell", strategy.short)

// Submit the exit order (stop loss)
stopLossPrice = strategy.position_avg_price * (1 - stoplossPct / 100)
strategy.exit("Exit", "Buy", stop=stopLossPrice)
